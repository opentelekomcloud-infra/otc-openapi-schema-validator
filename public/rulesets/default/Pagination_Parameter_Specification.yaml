rules:
  - id: "FIL-020-01-2507-2507-M"
    title: "Pagination Parameters Consistency Check"
    message: Pagination must use either (offset+limit) or (marker+limit), not both.
    option: Mandatory
    location: path
    call:
      function: checkPaginationParameters
      functionParams:
        methods: ["get"]
        modes:
          - trigger: "offset"
            require: ["offset", "limit"]
            forbid: ["marker"]
          - trigger: "marker"
            require: ["marker", "limit"]
            forbid: ["offset"]
    description: This rule checks Offset-based pagination must use 'offset' and 'limit' parameters
    status: implemented
    severity: critical

  - id: "FIL-020-01-2507-2507-M-1"
    title: "Default Limit Enforcement"
    message: if 'limit' parameter exists, a default value of 1000 records must be assumed.
    option: Optional
    location: query
    element: url
    call:
      function: checkDefaultLimitValue
      functionParams:
        methods: ["get"]
        defaultValue: "1000"
    description: This rule checks if 'limit' is not specified, a default of 1000 records must be assumed
    status: implemented
    severity: medium
