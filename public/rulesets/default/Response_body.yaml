rules:
  - id: "COD-040-01-2507-2507-M"
    title: "Response Body JSON, BSON, XML or Octet-Stream Encapsulation"
    message: "The response body must support JSON, BSON, XML or Octet-Stream encapsulation. If a body is present, the Content-Type header must be application/json, application/bson, application/xml or application/octet-stream."
    option: Mandatory
    location: paths
    element: responses
    call:
      function: checkResponseEncapsulation
      functionParams:
        headers:
          - Content-Type
        content:
          - application/json
          - application/bson
        excludeContent:
          - application/xml
          - application/octet-stream
          - application/xml;charset=UTF-8
        methods:
          - "post"
          - "put"
          - "delete"
    severity: "medium"
    status: implemented
